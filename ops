{"author":{"id":"778d0d8adcf381faef152a6577de9902e431612075f7585af0b6ac9d7d1c1475"},"ops":[{"type":6,"author":{"id":"778d0d8adcf381faef152a6577de9902e431612075f7585af0b6ac9d7d1c1475"},"timestamp":1553222657,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDE5OTY4MjQyNw=="},"nonce":"HMy4ivz8ryQq5EG1xEXNHosuarw=","target":"b2143f8eef7cb78abea55e07ba243a2d11c04f40d5ec39b328bbc596439f54c0","message":"#include\t\u003csys/time.h\u003e\nvoid MomentTest ( pfHash hash){\n\tprintf(\"Running MomentTest...\\n\");\n\tunsigned\tk=0,\ts=0;\n\tunsigned long long l,\th,\ta=0,\tb=0,\tx;\n\ttimeval\tbeg,\tend;\n\tgettimeofday(\u0026beg,NULL);\n\thash(\u0026k,4,s,\u0026l);\tfor(unsigned\ti=1;\ti\u003e0;\ti++){\thash(\u0026i,4,s,\u0026h);\tx=__builtin_popcountll(l^h);\ta+=x*x*x*x*x;\tl=h;\t}\n\thash(\u0026k,4,s,\u0026l);\tfor(unsigned\ti=1;\ti\u003e0;\ti++){\thash(\u0026k,4,i,\u0026h);\tx=__builtin_popcountll(l^h);\tb+=x*x*x*x*x;\tl=h;\t}\n\tgettimeofday(\u0026end,NULL);\n\tprintf(\"KeySeedMomentBias:\\t%g\\n\",\tfabs((double)a/0xffffffff-(double)b/0xffffffff));\t\n\tprintf(\"MomentTime\\t%g ns/hash\\n\",(end.tv_sec-beg.tv_sec+1e-6*(end.tv_usec-beg.tv_usec))/0x200000000ull*1e9);\n}\n\n64bit hash functions:\nt1ha2_atonce\t68.3427\tPASS\nwyhash\t97.5489\tPASS\nxxHash64\t199.237\tPASS\nMUM\t401.8\tPASS\nfarmhash64_c\t536.879\tPASS\nSipHash\t807.371\tPASS\n//SipHash hints the lower bound of cutoff \n(c)metrohash64_2\t969.287\tPASS\nSpooky64\t1996.32\tPASS\n//maybe 10000 is good cutoff\n(c)metrohash64_1\t13612.2\tFAIL\nfasthash64\t65498.9\tFAIL\nxxh3\t181411\tFAIL\n\n//32 bit hash with fifth momoent should have 1/32.0 cutoff\n32bit hash functions:\nGoodOAAT\t1.04201\tPASS\nMUMlow:\t1.24215\tPASS\nCity32\t4.71543\tPASS\nwyhash32low\t5.67941\tPASS\n//SipHash/32.0 hints the lower bound of cutoff\nfasthash32\t34.4996\tPASS\nCity64low\t54.8737\tPASS\nSpooky32\t155.019\tPASS\n//10000/32.0=340\nxxHash32\t486.913\tFAIL\nMurmur3A\t8132.47\tFAIL\nPMurHash32\t8132.47\tFAIL\n\nwyhash have been updated accord to this new finding :-)","files":null},{"type":6,"author":{"id":"778d0d8adcf381faef152a6577de9902e431612075f7585af0b6ac9d7d1c1475"},"timestamp":1553225600,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdDE5OTY5Mzk2OQ=="},"nonce":"RRBIq4k/4s/wMsS2MSTy35NUwkg=","target":"b2143f8eef7cb78abea55e07ba243a2d11c04f40d5ec39b328bbc596439f54c0","message":"void MomentTest ( pfHash hash){\n\tprintf(\"Running MomentTest...\\n\");\n\tunsigned\tk=0,\ts=0;\n\tunsigned long long l,\th,\tx;\n\tlong double sa=0,\tsaa=0,\tsb=0,\tsbb=0,\tn=0xffffffffull;\n\thash(\u0026k,4,s,\u0026l);\tfor(unsigned\ti=1;\ti\u003e0;\ti++){\thash(\u0026i,4,s,\u0026h);\tx=__builtin_popcountll(l^h);\tx=x*x*x*x*x;\tsa+=x;\tsaa+=x*x;\tl=h;\t}\n\thash(\u0026k,4,s,\u0026l);\tfor(unsigned\ti=1;\ti\u003e0;\ti++){\thash(\u0026k,4,i,\u0026h);\tx=__builtin_popcountll(l^h);\tx=x*x*x*x*x;\tsb+=x;\tsbb+=x*x;\tl=h;\t}\n\tsa/=n;\tsaa=(saa/n-sa*sa)/n;\tsb/=n;\tsbb=(sbb/n-sb*sb)/n;\tdouble\tchi2=(sa-sb)*(sa-sb)/(saa+sbb);\n\tprintf(\"KeySeedMomentChi2:\\t%g\\t%s\\n\",\tchi2,\tchi2\u003e3.84145882069413?\"FAIL!!!!\":\"PASS\");\n}\n\n64bit hash chisq:\nt1ha2_atonce\t0.0170684\tPASS\nwyhash\t0.0347747\tPASS\nxxHash64\t0.145062\tPASS\nMUM\t0.589962\tPASS\nfarmhash64_c\t1.05341\tPASS\nSipHash\t2.38213\tPASS\n(c)metrohash64_2\t3.43323\tPASS\nSpooky64\t14.5622\tFAIL\n(c)metrohash64_1\t674.801\tFAIL\nfasthash64\t15556.8\tFAIL\nxxh3\t117826\tFAIL\n\n32bit hash chisq:\nGoodOAAT\t0.00156549\tPASS\nMUMlow:\t0.0022278\tPASS\nCity32\t0.0325398\tPASS\nwyhash32low\t0.0465943\tPASS\nfasthash32\t1.7319\tPASS\nCity64low\t4.3816\tFAIL\nSpooky32\t34.9565\tFAIL\nxxHash32\t344.586\tFAIL\nMurmur3A\t97936.1\tFAIL\n\nwyhash have been updated accord to this new finding :-)","files":null}]}