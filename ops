{"author":{"id":"656dd67b0f9bdf8bc451c83ff8f36ef959de2c8b4781d218d9958f9e71ef0639"},"ops":[{"type":1,"timestamp":1638239418,"metadata":{"github-id":"I_kwDOARWYbc4_lMUe","github-url":"https://github.com/rurban/smhasher/issues/218","origin":"github"},"nonce":"qptxpVa1Bo+hMz5HwJlP5r8xtBo=","title":"New PerlinNoise test","message":"It breaks both `wyhash` and `XXH3_64`, unfortunately.\n\n```\nstatic inline uint64_t pn_expand_val( const uint64_t v, const int vsize,\n\tconst int spacing )\n{\n\tuint64_t r = 0;\n\tint p = 0;\n\n\tfor( int i = 0; i \u003c vsize; i++ )\n\t{\n\t\tr |= (( v \u003e\u003e i ) \u0026 1 ) \u003c\u003c p;\n\t\tp += spacing;\n\t}\n\n\treturn( r );\n}\n\n{\n\tconst int pnbits = 9;\n\tconst int pncount = 1 \u003c\u003c pnbits;\n\tconst int pnspacing = 3;\n\tconst int ocount = 4;\n\tconst int lcount = 6;\n\tuint8_t msg[ 64 ];\n\n\tfor( int i = 1; i \u003c pncount; i++ )\n\t{\n\t\tuint32_t seed = (uint32_t) pn_expand_val( i, pnbits, pnspacing );\n\n\t\tfor( int k = 1; k \u003c pncount; k++ )\n\t\t{\n\t\t\tuint32_t key = (uint32_t) pn_expand_val( k, pnbits, pnspacing );\n\n\t\t\tfor( int o = 0; o \u003c ocount; o++ )\n\t\t\t{\n\t\t\t\tmemset( msg, 0, sizeof( msg ));\n\t\t\t\tmemcpy( msg + o * 4, \u0026key, sizeof( key ));\n\n\t\t\t\tfor( int l = 0; l \u003c lcount; l++ )\n\t\t\t\t{\n\t\t\t\t\tconst size_t msgl = 16 + l * 8;\n//\t\t\t\t\th = hash( \u0026msg, msgl, seed );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst double tot = (uint64_t) ( pncount - 1 ) * ( pncount - 1 ) *\n\t\tocount * lcount;\n```","files":null}]}