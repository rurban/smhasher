{"author":{"id":"382e0604a0cc648df6764230ea7ce0b626217738167eb2200238272b6c52e2a8"},"ops":[{"type":3,"author":{"id":"382e0604a0cc648df6764230ea7ce0b626217738167eb2200238272b6c52e2a8"},"timestamp":1598135415,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDY3ODcwMzA3Ng==","github-url":"https://github.com/rurban/smhasher/issues/121#issuecomment-678703076"},"nonce":"BPM94/p3Is6OpOhwI1ukMOVFqA0=","message":"@avaneev @Cyan4973\n\nHashing 'Shakespeare' - complete works... with `gcc -O3 -mavx -fomit-frame-pointer` 64bit code.\n\nOkay, the final benchmark for small keys (back-to-back) - RAW hashing speed **without touching** the slots, i5-7200U @2.5GHz, Windows 10 64bit:\n\n\nBench #1: Big key (5MB), RAW SPEED:\n\n```\n------------------------------------------------------------\n| Hasher / Speed in Bytes/s for          | 5,784,758 bytes |\n------------------------------------------------------------\n| WYHASH final (GCC 7.3.0)               |  12,883,648,106 |\n| FNV1A-Pippip-Yurii (GCC 7.3.0)         |   6,032,072,992 |\n| XXH3 (GCC 7.3.0)                       |  14,534,567,839 | ! Fastest !\n| iSCSI CRC32 (GCC 7.3.0)                |   3,031,843,815 |\n| SHA3-224 (GCC 7.3.0)                   |      14,178,328 |    \n| PRVhash42_32 version 2.11 (GCC 7.3.0)  |   1,709,949,157 |\n------------------------------------------------------------\n```\n\nBench #2: Small keys 4,6,8,10,12,14,16,18,36,64 bytes long at first position, in that order, and then advancing one position in the file until the end:\n```\n-----------------------------------------------------------------------------\n| Hasher / Speed in keys/s for           | 4,6,8,10,12,14,16,18,36,64 bytes |\n-----------------------------------------------------------------------------\n| WYHASH final (GCC 7.3.0)               |                      222,490,615 |\n| FNV1A-Pippip-Yurii (GCC 7.3.0)         |                      312,689,513 | ! Fastest !\n| XXH3 (GCC 7.3.0)                       |                      212,674,852 |\n| iSCSI CRC32 (GCC 7.3.0)                |                      258,248,035 |\n| SHA3-224 (GCC 7.3.0)                   |                           97,766 |    \n| PRVhash42_32 version 2.11 (GCC 7.3.0)  |                       52,828,821 |\n-----------------------------------------------------------------------------\n```\n\nBench #3: Small keys 4 bytes long at first position, and then advancing one position in the file until the end, then same for 6,8,10,12,14,16,18,36,64:\n\n```\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n| Hasher / Speed in Keys/s for            |     4 bytes |     6 bytes |     8 bytes |    10 bytes |    12 bytes |    14 bytes |    16 bytes |    18 bytes |    36 bytes |    64 bytes | Total Collisions |\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n| WYHASH final (GCC 7.3.0)                | 321,375,277 | 321,375,166 | 321,375,055 | 321,374,944 | 321,374,833 | 321,374,722 | 321,374,611 | 206,597,892 | 186,603,967 | 160,685,972 |             N.A. |\n| FNV1A-Pippip-Yurii (GCC 7.3.0)          | 525,886,818 | 482,062,750 | 525,886,454 | 525,886,272 | 525,886,090 | 578,474,500 | 525,885,727 | 385,649,400 | 304,459,105 | 241,028,958 |             N.A. |\n| XXH3 (GCC 7.3.0)                        | 241,031,458 | 241,031,375 | 251,510,913 | 275,464,238 | 275,464,142 | 275,464,047 | 275,463,952 | 214,249,666 | 156,343,864 | 156,343,108 |             N.A. |\n| iSCSI CRC32 (GCC 7.3.0)                 | 723,094,375 | 642,750,333 | 578,475,100 | 525,886,272 | 482,062,250 | 444,980,384 | 413,195,928 | 361,546,312 | 206,597,250 | 109,145,188 |             N.A. |\n| SHA3-224 (GCC 7.3.0)                    |      98,094 |      97,975 |      97,890 |      97,965 |      97,879 |      98,187 |      98,473 |      97,885 |      97,751 |      97,364 |             N.A. |\n| PRVhash42_32 version 2.11 (GCC 7.3.0)   |  91,821,507 |  91,821,476 |  80,343,763 |  77,129,986 |  68,866,035 |  68,055,823 |  60,892,031 |  60,892,010 |  38,564,820 |  24,511,419 |             N.A. |\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n```\n\nNote0: All runs were done in REAL-TIME priority.\nNote1: 'WYHASH' is condomless i.e. it has `#define WYHASH_CONDOM 0 //0,1,2`.\nNote2: 'WYHASH' for keys 4..64 (one keysize (or all keysizes) at a time, back-to-back) is slower than 'Pippip'.\nNote3: The fastest hasher for 4..8 range is the hardware CRC32C.\nNote4: To reproduce the results, the benchmark package is here: www.sanmayce.com/Fastest_Hash/Lookuperorama.c_r9.zip\nNote5: To run the bench just type `E:\\Lookuperorama.c_r9\u003ebench.bat KAZE_www.gutenberg.org_ebooks_100.txt`\n\n@rurban \n\u003e Obviously there are much faster arch-specific functions than wyhash. But it is the fastest generic hash function which passes all tests, whilst also being small enough.\n\nFNV1A-Pippip-Yurii is the only (known to me) function that outspeeds (in hashtable lookups) the hardware CRC32C.\n\n\nThe console dump:\n\n```\nE:\\N\\Lookuperorama.c_r9\u003eLookuperorama_GCC-7.3.0_WY_64bit.exe \"KAZE_www.gutenberg.org_ebooks_100.txt\" x 20 1200 i\n\nRAW Hashing Speed for key 5,784,758 bytes long = 12,798,137,168 12,883,648,106 12,826,514,412 12,855,017,777 12,855,017,777 | 12,883,648,106 BYTES-PER-SECOND\nRAW Hashing Speed for keys 04 bytes long = 321,375,277 KEYS-PER-SECOND; all in 18 clocks\nRAW Hashing Speed for keys 06 bytes long = 321,375,166 KEYS-PER-SECOND; all in 18 clocks\nRAW Hashing Speed for keys 08 bytes long = 321,375,055 KEYS-PER-SECOND; all in 18 clocks\nRAW Hashing Speed for keys 10 bytes long = 321,374,944 KEYS-PER-SECOND; all in 18 clocks\nRAW Hashing Speed for keys 12 bytes long = 321,374,833 KEYS-PER-SECOND; all in 18 clocks\nRAW Hashing Speed for keys 14 bytes long = 321,374,722 KEYS-PER-SECOND; all in 18 clocks\nRAW Hashing Speed for keys 16 bytes long = 321,374,611 KEYS-PER-SECOND; all in 18 clocks\nRAW Hashing Speed for keys 18 bytes long = 206,597,892 KEYS-PER-SECOND; all in 28 clocks\nRAW Hashing Speed for keys 36 bytes long = 186,603,967 KEYS-PER-SECOND; all in 31 clocks\nRAW Hashing Speed for keys 64 bytes long = 160,685,972 KEYS-PER-SECOND; all in 36 clocks\nThe hash scanner - hashing in one pass all orders - TESTING CUMULATIVE PERFORMANCE...\nRAW Hashing Speed for keys 4,6,8,10,12,14,16,18,36,64 bytes long = 222,490,615 KEYS-PER-SECOND; all in 260 clocks\n\nE:\\N\\Lookuperorama.c_r9\u003eLookuperorama_GCC-7.3.0_Pippip_64bit.exe \"KAZE_www.gutenberg.org_ebooks_100.txt\" x 20 1200 i\n\nRAW Hashing Speed for key 5,784,758 bytes long = 6,000,786,307 6,019,519,250 6,019,519,250 6,032,072,992 6,019,519,250 | 6,032,072,992 BYTES-PER-SECOND\nRAW Hashing Speed for keys 04 bytes long = 525,886,818 KEYS-PER-SECOND; all in 11 clocks\nRAW Hashing Speed for keys 06 bytes long = 482,062,750 KEYS-PER-SECOND; all in 12 clocks\nRAW Hashing Speed for keys 08 bytes long = 525,886,454 KEYS-PER-SECOND; all in 11 clocks\nRAW Hashing Speed for keys 10 bytes long = 525,886,272 KEYS-PER-SECOND; all in 11 clocks\nRAW Hashing Speed for keys 12 bytes long = 525,886,090 KEYS-PER-SECOND; all in 11 clocks\nRAW Hashing Speed for keys 14 bytes long = 578,474,500 KEYS-PER-SECOND; all in 10 clocks\nRAW Hashing Speed for keys 16 bytes long = 525,885,727 KEYS-PER-SECOND; all in 11 clocks\nRAW Hashing Speed for keys 18 bytes long = 385,649,400 KEYS-PER-SECOND; all in 15 clocks\nRAW Hashing Speed for keys 36 bytes long = 304,459,105 KEYS-PER-SECOND; all in 19 clocks\nRAW Hashing Speed for keys 64 bytes long = 241,028,958 KEYS-PER-SECOND; all in 24 clocks\nThe hash scanner - hashing in one pass all orders - TESTING CUMULATIVE PERFORMANCE...\nRAW Hashing Speed for keys 4,6,8,10,12,14,16,18,36,64 bytes long = 312,689,513 KEYS-PER-SECOND; all in 185 clocks\n\nE:\\N\\Lookuperorama.c_r9\u003eLookuperorama_GCC-7.3.0_XXH3_64bit.exe \"KAZE_www.gutenberg.org_ebooks_100.txt\" x 20 1200 i\n\nRAW Hashing Speed for key 5,784,758 bytes long = 13,547,442,622 14,534,567,839 14,498,140,350 14,283,353,086 14,389,945,273 | 14,534,567,839 BYTES-PER-SECOND\nRAW Hashing Speed for keys 04 bytes long = 241,031,458 KEYS-PER-SECOND; all in 24 clocks\nRAW Hashing Speed for keys 06 bytes long = 241,031,375 KEYS-PER-SECOND; all in 24 clocks\nRAW Hashing Speed for keys 08 bytes long = 251,510,913 KEYS-PER-SECOND; all in 23 clocks\nRAW Hashing Speed for keys 10 bytes long = 275,464,238 KEYS-PER-SECOND; all in 21 clocks\nRAW Hashing Speed for keys 12 bytes long = 275,464,142 KEYS-PER-SECOND; all in 21 clocks\nRAW Hashing Speed for keys 14 bytes long = 275,464,047 KEYS-PER-SECOND; all in 21 clocks\nRAW Hashing Speed for keys 16 bytes long = 275,463,952 KEYS-PER-SECOND; all in 21 clocks\nRAW Hashing Speed for keys 18 bytes long = 214,249,666 KEYS-PER-SECOND; all in 27 clocks\nRAW Hashing Speed for keys 36 bytes long = 156,343,864 KEYS-PER-SECOND; all in 37 clocks\nRAW Hashing Speed for keys 64 bytes long = 156,343,108 KEYS-PER-SECOND; all in 37 clocks\nThe hash scanner - hashing in one pass all orders - TESTING CUMULATIVE PERFORMANCE...\nRAW Hashing Speed for keys 4,6,8,10,12,14,16,18,36,64 bytes long = 212,674,852 KEYS-PER-SECOND; all in 272 clocks\n\nE:\\N\\Lookuperorama.c_r9\u003eLookuperorama_GCC-7.3.0_CRC32C_64bit.exe \"KAZE_www.gutenberg.org_ebooks_100.txt\" x 20 1200 i\n\nRAW Hashing Speed for key 5,784,758 bytes long = 3,025,501,046 3,031,843,815 3,031,843,815 3,031,843,815 3,031,843,815 | 3,031,843,815 BYTES-PER-SECOND\nRAW Hashing Speed for keys 04 bytes long = 723,094,375 KEYS-PER-SECOND; all in 8 clocks\nRAW Hashing Speed for keys 06 bytes long = 642,750,333 KEYS-PER-SECOND; all in 9 clocks\nRAW Hashing Speed for keys 08 bytes long = 578,475,100 KEYS-PER-SECOND; all in 10 clocks\nRAW Hashing Speed for keys 10 bytes long = 525,886,272 KEYS-PER-SECOND; all in 11 clocks\nRAW Hashing Speed for keys 12 bytes long = 482,062,250 KEYS-PER-SECOND; all in 12 clocks\nRAW Hashing Speed for keys 14 bytes long = 444,980,384 KEYS-PER-SECOND; all in 13 clocks\nRAW Hashing Speed for keys 16 bytes long = 413,195,928 KEYS-PER-SECOND; all in 14 clocks\nRAW Hashing Speed for keys 18 bytes long = 361,546,312 KEYS-PER-SECOND; all in 16 clocks\nRAW Hashing Speed for keys 36 bytes long = 206,597,250 KEYS-PER-SECOND; all in 28 clocks\nRAW Hashing Speed for keys 64 bytes long = 109,145,188 KEYS-PER-SECOND; all in 53 clocks\nThe hash scanner - hashing in one pass all orders - TESTING CUMULATIVE PERFORMANCE...\nRAW Hashing Speed for keys 4,6,8,10,12,14,16,18,36,64 bytes long = 258,248,035 KEYS-PER-SECOND; all in 224 clocks\n\nE:\\N\\Lookuperorama.c_r9\u003eLookuperorama_GCC-7.3.0_SHA3_64bit.exe \"KAZE_www.gutenberg.org_ebooks_100.txt\" x 20 1200 i\n\nRAW Hashing Speed for key 5,784,758 bytes long = 13,905,668 14,109,165 14,178,328 14,143,662 14,143,662 | 14,178,328 BYTES-PER-SECOND\nRAW Hashing Speed for keys 04 bytes long = 98,094 KEYS-PER-SECOND; all in 58971 clocks\nRAW Hashing Speed for keys 06 bytes long = 97,975 KEYS-PER-SECOND; all in 59043 clocks\nRAW Hashing Speed for keys 08 bytes long = 97,890 KEYS-PER-SECOND; all in 59094 clocks\nRAW Hashing Speed for keys 10 bytes long = 97,965 KEYS-PER-SECOND; all in 59049 clocks\nRAW Hashing Speed for keys 12 bytes long = 97,879 KEYS-PER-SECOND; all in 59101 clocks\nRAW Hashing Speed for keys 14 bytes long = 98,187 KEYS-PER-SECOND; all in 58915 clocks\nRAW Hashing Speed for keys 16 bytes long = 98,473 KEYS-PER-SECOND; all in 58744 clocks\nRAW Hashing Speed for keys 18 bytes long = 97,885 KEYS-PER-SECOND; all in 59097 clocks\nRAW Hashing Speed for keys 36 bytes long = 97,751 KEYS-PER-SECOND; all in 59178 clocks\nRAW Hashing Speed for keys 64 bytes long = 97,364 KEYS-PER-SECOND; all in 59413 clocks\nThe hash scanner - hashing in one pass all orders - TESTING CUMULATIVE PERFORMANCE...\nRAW Hashing Speed for keys 4,6,8,10,12,14,16,18,36,64 bytes long = 97,766 KEYS-PER-SECOND; all in 591690 clocks\n\nE:\\N\\Lookuperorama.c_r9\u003eLookuperorama_GCC-7.3.0_PRV_64bit.exe \"KAZE_www.gutenberg.org_ebooks_100.txt\" x 20 1200 i\n\nRAW Hashing Speed for key 5,784,758 bytes long = 1,706,921,805 1,699,899,500 1,707,929,731 1,708,938,847 1,709,949,157 | 1,709,949,157 BYTES-PER-SECOND\nRAW Hashing Speed for keys 04 bytes long = 91,821,507 KEYS-PER-SECOND; all in 63 clocks\nRAW Hashing Speed for keys 06 bytes long = 91,821,476 KEYS-PER-SECOND; all in 63 clocks\nRAW Hashing Speed for keys 08 bytes long = 80,343,763 KEYS-PER-SECOND; all in 72 clocks\nRAW Hashing Speed for keys 10 bytes long = 77,129,986 KEYS-PER-SECOND; all in 75 clocks\nRAW Hashing Speed for keys 12 bytes long = 68,866,035 KEYS-PER-SECOND; all in 84 clocks\nRAW Hashing Speed for keys 14 bytes long = 68,055,823 KEYS-PER-SECOND; all in 85 clocks\nRAW Hashing Speed for keys 16 bytes long = 60,892,031 KEYS-PER-SECOND; all in 95 clocks\nRAW Hashing Speed for keys 18 bytes long = 60,892,010 KEYS-PER-SECOND; all in 95 clocks\nRAW Hashing Speed for keys 36 bytes long = 38,564,820 KEYS-PER-SECOND; all in 150 clocks\nRAW Hashing Speed for keys 64 bytes long = 24,511,419 KEYS-PER-SECOND; all in 236 clocks\nThe hash scanner - hashing in one pass all orders - TESTING CUMULATIVE PERFORMANCE...\nRAW Hashing Speed for keys 4,6,8,10,12,14,16,18,36,64 bytes long = 52,828,821 KEYS-PER-SECOND; all in 1095 clocks\n```","files":null}]}